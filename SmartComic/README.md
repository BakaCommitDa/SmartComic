# SmartComic 追漫 APP

## 技术栈
- **React 19.1** - 现代化的React框架，支持并发特性和自动批处理
- **React Router DOM 7.7** - 客户端路由管理，支持嵌套路由和路由守卫
- **Zustand 5.0** - 轻量级状态管理库，替代Redux的简洁方案
- **React Vant 3.3** - 移动端UI组件库，提供丰富的组件和图标
- **Axios 1.11** - HTTP客户端，支持请求拦截器和响应拦截器
- **Mock.js + Vite-plugin-mock** - 接口模拟和数据生成
- **JWT认证** - 基于Token的用户认证和授权机制
- **CSS Modules** - 组件级样式隔离，避免样式冲突
- **Vite 6.3** - 现代化构建工具，支持快速热重载和优化
- **PostCSS + PostCSS-pxtorem** - 移动端适配方案，自动转换px为rem

## 项目的架构
```
SmartComic/
├── src/
│   ├── components/          # 通用组件库
│   │   ├── LoadingSpinner/  # 加载组件
│   │   ├── LazyImage/       # 图片懒加载组件
│   │   ├── ErrorMessage/    # 错误提示组件
│   │   ├── TabSelector/     # 标签切换组件
│   │   └── ...
│   ├── pages/               # 页面组件
│   │   ├── Home/           # 首页
│   │   ├── Rankings/       # 排行榜
│   │   ├── Schedule/       # 排期表
│   │   ├── Search/         # 搜索页
│   │   ├── Profile/        # 个人中心
│   │   └── Login/          # 登录页
│   ├── store/               # 状态管理
│   │   ├── userStore.js    # 用户状态
│   │   ├── homeStore.js    # 首页状态
│   │   └── ...
│   ├── hooks/               # 自定义Hooks
│   │   ├── useDebounce.js  # 防抖Hook
│   │   └── useTitle.js     # 标题管理Hook
│   ├── api/                 # API接口
│   │   ├── config.js       # Axios配置
│   │   ├── user.js         # 用户相关API
│   │   └── ...
│   └── assets/              # 静态资源
├── mock/                    # Mock数据（独立于src）
│   ├── data.js             # 模拟数据
│   ├── jwt.js              # JWT认证Mock
│   └── mockServer.js       # Mock服务器配置
└── public/                  # 公共资源
```

## 开发前的准备

### 环境要求
- Node.js >= 16.0.0
- pnpm >= 8.0.0

### 依赖安装
```bash
# 核心依赖
pnpm add react react-dom react-router-dom zustand axios
pnpm add react-vant @react-vant/icons lib-flexible mockjs

# 开发依赖
pnpm add -D vite @vitejs/plugin-react vite-plugin-mock
pnpm add -D postcss postcss-pxtorem eslint
```

### 项目启动
```bash
# 安装依赖
pnpm install

# 启动开发服务器
pnpm dev

# 构建生产版本
pnpm build
```

## 项目亮点
- **移动端适配**：基于lib-flexible + postcss-pxtorem的完整响应式解决方案，支持各种屏幕尺寸
- **图片懒加载**：使用IntersectionObserver API实现高性能的图片按需加载，提升页面性能
- **状态管理**：Zustand轻量级状态管理，支持异步操作和持久化，替代复杂的Redux方案
- **组件封装**：高度可复用的Loading、ErrorMessage、LazyImage等通用组件，提高开发效率
- **路由优化**：React.lazy + Suspense实现代码分割和懒加载，减少首屏加载时间
- **性能优化**：React.memo、useCallback、useMemo实现组件和函数缓存，避免不必要的重渲染
- **搜索体验**：胶囊形状搜索框设计，支持垂直居中和响应式适配，提供良好的用户交互
- **数据复用**：Home页面智能集成排行榜和排期表数据，避免重复请求，提升数据加载效率
- **JWT认证**：完整的用户登录认证系统，支持Token自动刷新和路由守卫
- **Mock数据**：完整的接口模拟系统，支持开发阶段的数据测试和调试

## 功能模块

### 用户认证系统
- **登录页面**：基于JWT的用户认证，支持用户名密码登录
- **路由守卫**：自动拦截未登录用户，重定向到登录页面
- **状态持久化**：Token自动存储和刷新，保持用户登录状态
- **个人中心**：用户信息展示和退出登录功能

### 首页功能
- **搜索框**：胶囊形状设计，支持垂直居中和响应式适配
- **轮播图**：Banner组件，支持自动播放和手动切换
- **标签切换**：热门、排期、排行榜三个标签页，数据复用优化
- **数据集成**：智能复用排行榜和排期表数据，避免重复请求

### 排行榜系统
- **分类展示**：支持日榜、周榜、月榜等多种排行榜
- **数据切换**：标签切换时数据实时更新，性能优化
- **卡片组件**：RankingCard组件，展示评分、标签等信息
- **懒加载**：图片按需加载，提升页面性能

### 排期表功能
- **时间展示**：按日期展示动漫更新排期
- **卡片布局**：ScheduleCard组件，响应式设计
- **数据管理**：Zustand状态管理，数据流清晰

### 搜索功能
- **实时搜索**：基于useDebounce的防抖搜索
- **结果展示**：搜索结果列表，支持分页加载
- **历史记录**：搜索历史记录管理

### 移动端适配
- **响应式布局**：基于lib-flexible的移动端适配方案
- **TabBar导航**：底部导航栏，支持图标和文字
- **组件库集成**：React Vant组件库，提供丰富的移动端组件

## 项目的亮点和难点

### 技术亮点
- **完整的移动端适配方案**：基于lib-flexible + postcss-pxtorem的响应式解决方案
- **模块化CSS设计**：使用CSS Modules实现组件级样式隔离，避免样式冲突
- **组件化开发**：高度可复用的组件设计，提高开发效率和代码质量
- **状态管理清晰**：Zustand轻量级状态管理，数据流可控且易于维护
- **性能优化策略**：React.memo、useCallback、useMemo缓存机制，避免不必要的重渲染
- **搜索体验优化**：胶囊形状搜索框设计，支持垂直居中和响应式适配
- **数据复用机制**：Home页面智能复用排行榜和排期表数据，减少重复请求

### 技术难点
- **图片懒加载性能优化**：使用IntersectionObserver API实现高性能的图片按需加载
- **移动端适配挑战**：不同屏幕尺寸的完美适配，确保在各种设备上的良好体验
- **组件状态同步**：复杂组件间的状态同步和更新机制设计
- **第三方组件样式覆盖**：React Vant组件库的样式自定义和覆盖策略
- **搜索框响应式设计**：胶囊形状搜索框在不同设备上的垂直居中和高度调整
- **JWT认证集成**：Token自动刷新、路由守卫和状态持久化的完整实现

## 项目遇到过什么问题，怎么解决的

### 技术问题及解决方案

#### JWT认证实现问题
- **问题**：jsonwebtoken库在浏览器环境不兼容，导致JWT功能无法正常工作
- **解决**：实现自定义的JWT签名和验证函数，使用btoa/atob进行base64编码，确保浏览器兼容性

#### API路径重复问题
- **问题**：API请求路径出现重复的/api前缀，导致请求失败
- **解决**：调整API配置，移除重复的路径前缀，确保请求路径正确

#### 登录页面UI适配问题
- **问题**：移动端登录页面样式与设计稿差异较大，元素大小和位置不准确
- **解决**：通过多次迭代调整CSS样式，使用!important确保移动端样式优先级，实现精确的视觉还原

#### 个人中心状态切换问题
- **问题**：登录前后个人中心页面样式不一致，移动端适配效果差
- **解决**：实现条件渲染逻辑，为未登录状态添加专门的样式类，确保视觉一致性

#### 搜索框样式覆盖问题
- **问题**：React Vant Search组件样式难以覆盖，移动端高度调整不生效
- **解决**：使用多重样式覆盖策略（CSS !important + 内联样式），添加display:flex和align-items:center实现垂直居中

#### 图片懒加载优化问题
- **问题**：图片加载失败时缺少友好的错误处理
- **解决**：实现完整的错误状态处理，添加占位符和fallback图标，提升用户体验

#### 状态管理数据同步问题
- **问题**：组件间状态同步不及时，数据更新延迟
- **解决**：优化Zustand状态管理逻辑，添加适当的依赖项，确保状态变化及时响应

#### 移动端响应式适配问题
- **问题**：不同屏幕尺寸下的布局和样式不一致
- **解决**：完善CSS媒体查询，针对768px、480px、375px等关键断点进行精确适配

## 通用组件开发

### LoadingSpinner组件
- **居中方案**：使用position:fixed + top/left/right/bottom:0 + margin:auto实现完美居中
- **性能优化**：使用React.memo包装，避免不必要的重渲染
- **动画效果**：CSS动画实现旋转效果，提升用户体验

### LazyImage组件
- **懒加载实现**：基于IntersectionObserver API，实现高性能的图片按需加载
- **状态管理**：完整的加载状态、错误状态处理机制
- **用户体验**：提供占位符和fallback图标，确保页面布局稳定

### TabSelector组件
- **标签切换**：支持多个标签页的切换功能
- **状态管理**：激活状态的样式管理和状态同步
- **响应式设计**：适配不同屏幕尺寸，确保良好的移动端体验

### ScheduleCard组件
- **排期展示**：专门用于展示动漫更新排期的卡片组件
- **性能优化**：使用React.memo进行性能优化，避免不必要的重渲染
- **图片懒加载**：集成LazyImage组件，实现图片的按需加载
- **响应式布局**：适配不同屏幕尺寸，确保良好的显示效果

### RankingCard组件
- **排行榜展示**：专门用于展示排行榜信息的卡片组件
- **评分显示**：支持评分、标签等信息的展示
- **性能优化**：使用React.memo进行性能优化
- **图片懒加载**：集成LazyImage组件，提升页面性能

### ErrorMessage组件
- **错误处理**：统一的错误信息展示组件
- **用户友好**：提供友好的错误提示和操作建议
- **样式统一**：确保错误信息的样式与整体设计保持一致

### SearchBox组件
- **搜索功能**：胶囊形状的搜索框设计
- **响应式适配**：支持不同屏幕尺寸的适配
- **防抖优化**：集成useDebounce Hook，避免频繁请求
  - React.memo性能优化
  - 评分显示和标签展示
  - LazyImage图片懒加载